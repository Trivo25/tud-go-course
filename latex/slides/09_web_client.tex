% The Slide Definitions
\input{../templates/course_definitions}

% Author and Course information
\input{../templates/course_information}

% Presentation title
% TODO Change the topic of the lesson
\title{Python als Webclient}
\date{\today}


\begin{document}

\maketitle

\begin{frame}{Gliederung}
	\setbeamertemplate{section in toc}[sections numbered]
	\tableofcontents
\end{frame}


\begin{frame}[fragile]{Das Package urllib}
	Das Package \texttt{urllib} ist eine nützliche Sammlung mehrerer Module
	zur Arbeit mit URLs.
\end{frame}


\section{urllib.request}
\begin{frame}[fragile]{urllib.request}
	Das Modul \alert{\texttt{urllib.request}} enthält Funktionen und Klassen, welche
	beim Öffnen von URLs (vor allem über HTTP) helfen. \\[.5cm]
	Unterstützt werden:
	\begin{itemize}
		\item verschiedene Authentifizierungsarten
		\item Weiterleitungen
		\item Cookies
		\item und mehr...
	\end{itemize}
\end{frame}

\subsection{Öffnen einer URL}
\begin{frame}[fragile]{Öffnen einer URL}
	Das Öffnen einer URL wird über die Funktion \alert{\texttt{urlopen()}} realisiert:
	\lstinputlisting[lastline=5]{resources/09_web_client/urllib_calls.py}
\end{frame}

\begin{frame}[fragile]{Öffnen einer URL}
	\begin{description}
		\item[\textbf{url}] ein String für simple URLs oder ein \texttt{Request} Objekt für komplexere Anfragen
		\item[\textbf{data}] Daten, die an den Server gesendet werden sollen. \\
		vom Typ \texttt{bytes} oder ein Iterable von \texttt{bytes} Objekten \\[.75cm]
	\end{description}
	\textbf{Rückgabewerte}
	\begin{description}
		\item bei URLs mit http-Requests \\
		\hspace*{1cm}\texttt{httplib.client.HTTPResponse} Objekt
		\item bei ftp, file und data \\
		\hspace*{1cm}\texttt{urllib.addinfourl} Objekt
	\end{description}
\end{frame}

\subsection{Request Klasse}
\begin{frame}{Request Klasse}
	Um komplexere Anfragen stellen zu können, kann man Request Objekte verwenden:
	\lstinputlisting[firstline=8, lastline=10]{resources/09_web_client/urllib_calls.py}
\end{frame}

\begin{frame}{Request Klasse}
	\begin{description}
		\item[\textbf{url}] muss String mit gültiger URl sein
		\item[\textbf{data}] wie bei \textit{urlopen}
		\item[\textbf{headers}] \texttt{dict} mit \texttt{\{Header-Name : Header-Value, ...\}} oder \\
		\texttt{list} von Tupeln mit \texttt{[(Header-Name, Header-Value), ...]}
		\item[\textbf{method}] String, der Art des HTTP Request angibt (\texttt{HEAD}, \texttt{GET}, \texttt{POST}, ...)
	\end{description}
\end{frame}

\begin{frame}{Beispiel}
	\lstinputlisting{resources/09_web_client/req_example.py} \ \\[.5cm]
	Die Request Klasse kann man Verwenden zum:
	\begin{itemize}
		\item Kontrollieren der gesendeten Header \textit{(z.B. Content-Type oder User-Agent)}
		\item Kontrollieren der Method \texttt{POST}, \texttt{PUT} oder \texttt{HEAD}
		% TODO
	\end{itemize}
\end{frame}

\subsection{HTTPResponse Klasse}
\begin{frame}[fragile]{HTTPResponse Klasse}
	Objekte dieser Klasse werden nicht direkt vom User erstellt.
	\lstinputlisting[firstline=13]{resources/09_web_client/urllib_calls.py} \ \\[.5cm]
	Klasse enthält Funktionen und Variablen wie:
	\begin{itemize}
		\item \texttt{read()} - gibt zurückgelieferten Inhalt zurück
		\item \texttt{getheader()} oder \texttt{getheaders()} liefert einen/alle Header zurück
		\item \texttt{status} gibt den HTTP Statuscode zurück
		\item \texttt{version} gibt die HTTP Version zurück
	\end{itemize}
\end{frame}


\section{Andere Module}
\begin{frame}[fragile]{Andere Module}
	Das Package \alert{\texttt{urllib}} enthält au{\ss}erdem folgende Module:
	\begin{itemize}
		\item \texttt{urllib.error} \ \\
			Enthält Exceptions, die von \texttt{urllib.request} geworfen werden.
		\item \texttt{urllib.parse} \ \\
			Zum Parsen von URLs.
		\item \texttt{urllib.robotparse} \ \\
			Zum Parsen der \textit{robots.txt} von Webseiten.
	\end{itemize}
\end{frame}


\section{Das Requests-Modul}
\subsection{Installation}
\begin{frame}{Das Requests Modul}
	Das Requests Modul ist eine gute und für Menschen verständliche Alternative
	zu \texttt{urllib.requests}, das HTTP Requests vereinfacht. \\[.75cm]

	Das Requests Package lässt sich ganz einfach über \textbf{pip} installieren: \\
	\texttt{pip install requests}
\end{frame}

\begin{frame}{Beispiel}
	\lstinputlisting{resources/09_web_client/requests_example.py} \ \\[.5cm]
	Ruft die API-Seite von \textbf{GitHub} auf und authentifiziert sich mit Nutzername und Passwort.
\end{frame}

% nothing to do from here on
\end{document}
